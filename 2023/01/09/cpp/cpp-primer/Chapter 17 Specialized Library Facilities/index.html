<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Sakupinera" href="http://sakupinera.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="Sakupinera" href="http://sakupinera.github.io/atom.xml"><link rel="alternate" type="application/json" title="Sakupinera" href="http://sakupinera.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="读书笔记,C++"><link rel="canonical" href="http://sakupinera.github.io/2023/01/09/cpp/cpp-primer/Chapter%2017%20Specialized%20Library%20Facilities/"><title>C++ Primer - Chapter 17 Specialized Library Facilities - Cpp-Primer - Cpp | Hanamai Sora = Sakupinera</title><meta name="generator" content="Hexo 5.4.2"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">C++ Primer - Chapter 17 Specialized Library Facilities</h1><div class="meta"><span class="item" title="Created: 2023-01-09 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">Posted on</span> <time itemprop="dateCreated datePublished" datetime="2023-01-09T00:00:00+08:00">2023-01-09</time> </span><span class="item" title="Symbols count in article"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">Symbols count in article</span> <span>28k</span> <span class="text">words</span> </span><span class="item" title="Reading time"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">Reading time</span> <span>26 mins.</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Hanamai Sora</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://s2.loli.net/2023/03/08/psd5JEM2ADHakIt.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2023/03/08/R9PEJQ54o7HMAis.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2023/03/08/3J2uz5ejLcmstkD.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2023/03/08/mOQfkxXNYp8VGng.png"></li><li class="item" data-background-image="https://s2.loli.net/2023/03/08/Qi9cMFjDZq5V3tB.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2023/03/08/Rft6Y9pgTV5E17J.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">Home</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Cpp/" itemprop="item" rel="index" title="In Cpp"><span itemprop="name">Cpp</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Cpp/Cpp-Primer/" itemprop="item" rel="index" title="In Cpp-Primer"><span itemprop="name">Cpp-Primer</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="en"><link itemprop="mainEntityOfPage" href="http://sakupinera.github.io/2023/01/09/cpp/cpp-primer/Chapter%2017%20Specialized%20Library%20Facilities/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Sakupinera"><meta itemprop="description" content=", 保持你的决心！"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Sakupinera"></span><div class="body md" itemprop="articleBody"><h1 id="chapter-17-specialized-library-facilities"><a class="anchor" href="#chapter-17-specialized-library-facilities">#</a> Chapter 17 Specialized Library Facilities</h1><h2 id="the-tuple-type"><a class="anchor" href="#the-tuple-type">#</a> The tuple Type</h2><hr><h3 id="tuple类型"><a class="anchor" href="#tuple类型">#</a> tuple 类型</h3><ul><li><code>tuple</code> 是类似 <code>pair</code> 的模板，每个成员类型都可以不同，但 <code>tuple</code> 可以有任意数量的成员。</li><li>但每个确定的 <code>tuple</code> 类型的成员数目是固定的。</li><li>我们可以将 <code>tuple</code> 看做一个 “快速而随意” 的数据结构。</li></ul><p><strong>tuple 支持的操作</strong>：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>tuple&lt;T1, T2, ..., Tn&gt; t;</code></td><td><code>t</code> 是一个 <code>tuple</code> ，成员数为 <code>n</code> ，第 <code>i</code> 个成员的类型是 <code>Ti</code> 所有成员都进行值初始化。</td></tr><tr><td><code>tuple&lt;T1, T2, ..., Tn&gt; t(v1, v2, ..., vn);</code></td><td>每个成员用对应的初始值 <code>vi</code> 进行初始化。此构造函数是 <code>explicit</code> 的。</td></tr><tr><td><code>make_tuple(v1, v2, ..., vn)</code></td><td>返回一个用给定初始值初始化的 <code>tuple</code> 。 <code>tuple</code> 的类型从初始值的类型<strong>推断</strong>。</td></tr><tr><td><code>t1 == t2</code></td><td>当两个 <code>tuple</code> 具有相同数量的成员且成员对应相等时，两个 <code>tuple</code> 相等。</td></tr><tr><td><code>t1 relop t2</code></td><td><code>tuple</code> 的关系运算使用<strong>字典序</strong>。两个 <code>tuple</code> 必须具有相同数量的成员。</td></tr><tr><td><code>get&lt;i&gt;(t)</code></td><td>返回 <code>t</code> 的第 <code>i</code> 个数据成员的引用：如果 <code>t</code> 是一个左值，结果是一个左值引用；否则，结果是一个右值引用。 <code>tuple</code> 的所有成员都是 <code>public</code> 的。</td></tr><tr><td><code>tuple_size&lt;tupleType&gt;::value</code></td><td>一个类模板，可以通过一个 <code>tuple</code> 类型来初始化。它有一个名为 <code>value</code> 的 <code>public constexpr static</code> 数据成员，类型为 <code>size_t</code> ，表示给定 <code>tuple</code> 类型中成员的数量。</td></tr><tr><td><code>tuple_element&lt;i, tupleType&gt;::type</code></td><td>一个类模板，可以通过一个整型常量和一个 <code>tuple</code> 类型来初始化。它有一个名为 <code>type</code> 的 <code>public</code> 成员，表示给定 <code>tuple</code> 类型中指定成员的类型。</td></tr></tbody></table><h4 id="定义和初始化tuple"><a class="anchor" href="#定义和初始化tuple">#</a> 定义和初始化 tuple</h4><p>定义和初始化示例：</p><ul><li><code>tuple&lt;size_t, size_t, size_t&gt; threeD;</code></li><li><code>tuple&lt;size_t, size_t, size_t&gt; threeD&#123;1,2,3&#125;;</code></li><li><code>auto item = make_tuple(&quot;0-999-78345-X&quot;, 3, 2.00)；</code></li></ul><p>访问 tuple 成员：</p><ul><li><code>auto book = get&lt;0&gt;(item);</code></li><li><code>get&lt;2&gt;(item) *= 0.8;</code></li></ul><h4 id="使用tuple返回多个值"><a class="anchor" href="#使用tuple返回多个值">#</a> 使用 tuple 返回多个值</h4><ul><li><code>tuple</code> 最常见的用途是从一个函数返回多个值。</li></ul><hr><h3 id="exercise-171"><a class="anchor" href="#exercise-171">#</a> Exercise 17.1</h3><blockquote><p>定义一个保存三个 <code>int</code> 值的 <code>tuple</code> ，并将其成员分别初始化为 10、20 和 30。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">auto</span> t <span class="token operator">=</span> tuple<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">&#123;</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="exercise-172"><a class="anchor" href="#exercise-172">#</a> Exercise 17.2</h3><blockquote><p>定义一个 <code>tuple</code> ，保存一个 <code>string</code> 、一个 <code>vector&lt;string&gt;</code> 和一个 <code>pair&lt;string, int&gt;</code> 。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">auto</span> t <span class="token operator">=</span> tuple<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">,</span> pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">></span></pre></td></tr></table></figure><h3 id="exercise-173"><a class="anchor" href="#exercise-173">#</a> Exercise 17.3</h3><blockquote><p>重写 12.3 节中的 <code>TextQuery</code> 程序，使用 <code>tuple</code> 代替 <code>QueryResult</code> 类。你认为哪种设计更好？为什么？</p></blockquote><p>解：</p><p>程序略。</p><p>我认为 <code>tuple</code> 更方便。</p><h3 id="exercise-174"><a class="anchor" href="#exercise-174">#</a> Exercise 17.4</h3><blockquote><p>编写并测试你自己版本的 <code>findBook</code> 函数。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;tuple></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;utility></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;numeric></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_17_4_SalesData.h"</span></span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">//matches 有三个成员：1. 一个书店的索引。2. 指向书店中元素的迭代器。3. 指向书店中元素的迭代器。</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">typedef</span> tuple<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>size_type<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>              vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>const_iterator<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>              vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>const_iterator<span class="token operator">></span></pre></td></tr><tr><td data-num="17"></td><td><pre>    matches<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">//files 保存每家书店的销售记录</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">//findBook 返回一个 vector，每家销售了给定书籍的书店在其中都有一项</span></pre></td></tr><tr><td data-num="21"></td><td><pre>vector<span class="token operator">&lt;</span>matches<span class="token operator">></span> <span class="token function">findBook</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">>></span> <span class="token operator">&amp;</span>files<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                         <span class="token keyword">const</span> string <span class="token operator">&amp;</span>book<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    vector<span class="token operator">&lt;</span>matches<span class="token operator">></span> ret<span class="token punctuation">;</span> <span class="token comment">// 初始化为空 vector</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token comment">// 对每家书店，查找给定书籍匹配的记录范围</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> files<span class="token punctuation">.</span>cbegin<span class="token punctuation">;</span> it <span class="token operator">!=</span> files<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token comment">// 查找具有相同 ISBN 的 Sales_data 范围，found 是一个迭代器 pair</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">auto</span> found <span class="token operator">=</span> <span class="token function">equal_range</span><span class="token punctuation">(</span>it<span class="token operator">-></span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it<span class="token operator">-></span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">,</span> compareIsbn<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>found<span class="token punctuation">.</span>first <span class="token operator">!=</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span>  <span class="token comment">// 此书店销售了给定书籍</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            <span class="token comment">// 记住此书店的索引及匹配的范围</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            ret<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">make_tuple</span><span class="token punctuation">(</span>it <span class="token operator">-</span> files<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> found<span class="token punctuation">.</span>first<span class="token punctuation">,</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span> <span class="token comment">// 如果未找到匹配记录，ret 为空</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">void</span> <span class="token function">reportResults</span><span class="token punctuation">(</span>istream <span class="token operator">&amp;</span>in<span class="token punctuation">,</span> ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                       <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span> <span class="token operator">></span> <span class="token operator">&amp;</span>files<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    string s<span class="token punctuation">;</span>  <span class="token comment">// 要查找的书</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>in <span class="token operator">>></span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token keyword">auto</span> trans <span class="token operator">=</span> <span class="token function">findBook</span><span class="token punctuation">(</span>files<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>trans<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>            cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" not found in any stores"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            <span class="token keyword">continue</span><span class="token punctuation">;</span>  <span class="token comment">// 获得下一本要查找的书</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>store <span class="token operator">:</span> trans<span class="token punctuation">)</span>  <span class="token comment">// 对每家销售了给定书籍的书店</span></pre></td></tr><tr><td data-num="47"></td><td><pre>            <span class="token comment">//get&lt;n > 返回 store 中 tuple 的指定的成员</span></pre></td></tr><tr><td data-num="48"></td><td><pre>            os <span class="token operator">&lt;&lt;</span> <span class="token string">"store "</span> <span class="token operator">&lt;&lt;</span> <span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>store<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" sales: "</span></pre></td></tr><tr><td data-num="49"></td><td><pre>               <span class="token operator">&lt;&lt;</span> <span class="token function">accumulate</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre>               <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-175"><a class="anchor" href="#exercise-175">#</a> Exercise 17.5</h3><blockquote><p>重写 <code>findBook</code> ，令其返回一个 <code>pair</code> ，包含一个索引和一个迭代器 pair。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">typedef</span> std<span class="token double-colon punctuation">::</span>pair<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>size_type<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="2"></td><td><pre>                  std<span class="token double-colon punctuation">::</span>pair<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>const_iterator<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>                            std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>const_iterator<span class="token operator">>></span></pre></td></tr><tr><td data-num="4"></td><td><pre>                                                                      matches_pair<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>matches_pair<span class="token operator">></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">findBook_pair</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span> <span class="token operator">></span> <span class="token operator">&amp;</span>files<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>              <span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string <span class="token operator">&amp;</span>book<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>matches_pair<span class="token operator">></span> ret<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> files<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> files<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">auto</span> found <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">equal_range</span><span class="token punctuation">(</span>it<span class="token operator">-></span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it<span class="token operator">-></span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">,</span> compareIsbn<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>found<span class="token punctuation">.</span>first <span class="token operator">!=</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            ret<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">make_pair</span><span class="token punctuation">(</span>it <span class="token operator">-</span> files<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                                         std<span class="token double-colon punctuation">::</span><span class="token function">make_pair</span><span class="token punctuation">(</span>found<span class="token punctuation">.</span>first<span class="token punctuation">,</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-176"><a class="anchor" href="#exercise-176">#</a> Exercise 17.6</h3><blockquote><p>重写 <code>findBook</code> ，不使用 <code>tuple</code> 和 <code>pair</code> 。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">struct</span> <span class="token class-name">matches_struct</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>size_type st<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>const_iterator first<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>const_iterator last<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token function">matches_struct</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>size_type s<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                   std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>const_iterator f<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>                   std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token double-colon punctuation">::</span>const_iterator l<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">st</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">first</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">last</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>matches_struct<span class="token operator">></span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token function">findBook_struct</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span> <span class="token operator">></span> <span class="token operator">&amp;</span>files<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>                <span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string <span class="token operator">&amp;</span>book<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>matches_struct<span class="token operator">></span> ret<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> files<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> files<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">auto</span> found <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">equal_range</span><span class="token punctuation">(</span>it<span class="token operator">-></span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it<span class="token operator">-></span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">,</span> compareIsbn<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>found<span class="token punctuation">.</span>first <span class="token operator">!=</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            ret<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">matches_struct</span><span class="token punctuation">(</span>it <span class="token operator">-</span> files<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> found<span class="token punctuation">.</span>first<span class="token punctuation">,</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-177"><a class="anchor" href="#exercise-177">#</a> Exercise 17.7</h3><blockquote><p>解释你更倾向于哪个版本的 <code>findBook</code> ，为什么。</p></blockquote><p>解：</p><p>使用 <code>tuple</code> 的版本。很明显更加灵活方便。</p><h3 id="exercise-178"><a class="anchor" href="#exercise-178">#</a> Exercise 17.8</h3><blockquote><p>在本节最后一段代码中，如果我们将 <code>Sales_data()</code> 作为第三个参数传递给 <code>accumulate</code> ，会发生什么？</p></blockquote><p>解：</p><p>结果是 0，以为 <code>Sales_data</code> 是默认初始化的。</p><h2 id="the-bitset-type"><a class="anchor" href="#the-bitset-type">#</a> The bitset Type</h2><hr><h3 id="bitset类型"><a class="anchor" href="#bitset类型">#</a> bitset 类型</h3><ul><li>处理二进制位的有序集；</li><li><code>bitset</code> 也是类模板，但尖括号中输入的是 <code>bitset</code> 的长度而不是元素类型，因为元素类型是固定的，都是一个二进制位。</li></ul><p>初始化 <code>bitset</code> 的方法：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>bitset&lt;n&gt; b;</code></td><td><code>b</code> 有 <code>n</code> 位；每一位均是 0. 此构造函数是一个 <code>constexpr</code> 。</td></tr><tr><td><code>bitset&lt;n&gt; b(u);</code></td><td><code>b</code> 是 <code>unsigned long long</code> 值 <code>u</code> 的低 <code>n</code> 位的拷贝。如果 <code>n</code> 大于 <code>unsigned long long</code> 的大小，则 <code>b</code> 中超出 <code>unsigned long long</code> 的高位被置为 0。此构造函数是一个 <code>constexpr</code> 。</td></tr><tr><td><code>bitset&lt;n&gt; b(s, pos, m, zero, one);</code></td><td><code>b</code> 是 <code>string s</code> 从位置 <code>pos</code> 开始 <code>m</code> 个字符的拷贝。 <code>s</code> 只能包含字符 <code>zero</code> 或 <code>one</code> ：如果 <code>s</code> 包含任何其他字符，构造函数会抛出 <code>invalid_argument</code> 异常。字符在 <code>b</code> 中分别保存为 <code>zero</code> 和 <code>one</code> 。 <code>pos</code> 默认为 0， <code>m</code> 默认为 <code>string::npos</code> ， <code>zero</code> 默认为 '0'， <code>one</code> 默认为 '1'。</td></tr><tr><td><code>bitset&lt;n&gt; b(cp, pos, m, zero, one);</code></td><td>和上一个构造函数相同，但从 <code>cp</code> 指向的字符数组中拷贝字符。如果未提供 <code>m</code> ，则 <code>cp</code> 必须指向一个 <code>C</code> 风格字符串。如果提供了 <code>m</code> ，则从 <code>cp</code> 开始必须至少有 <code>m</code> 个 <code>zero</code> 或 <code>one</code> 字符。</td></tr></tbody></table><p>初始化案例；</p><ul><li><code>bitset&lt;13&gt; bitvec1(0xbeef);</code></li><li><code>bitset&lt;32&gt; bitvec4(&quot;1100&quot;);</code></li></ul><p><code>bitset</code> 操作：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>b.any()</code></td><td><code>b</code> 中是否存在 1。</td></tr><tr><td><code>b.all()</code></td><td><code>b</code> 中都是 1。</td></tr><tr><td><code>b.none()</code></td><td><code>b</code> 中是否没有 1。</td></tr><tr><td><code>b.count()</code></td><td><code>b</code> 中 1 的个数。</td></tr><tr><td><code>b.size()</code></td><td></td></tr><tr><td><code>b.test(pos)</code></td><td><code>pos</code> 下标是否是 1</td></tr><tr><td><code>b.set(pos)</code></td><td><code>pos</code> 置 1</td></tr><tr><td><code>b.set()</code></td><td>所有都置 1</td></tr><tr><td><code>b.reset(pos)</code></td><td>将位置 <code>pos</code> 处的位复位</td></tr><tr><td><code>b.reset()</code></td><td>将 <code>b</code> 中所有位复位</td></tr><tr><td><code>b.flip(pos)</code></td><td>将位置 <code>pos</code> 处的位取反</td></tr><tr><td><code>b.flip()</code></td><td>将 <code>b</code> 中所有位取反</td></tr><tr><td><code>b[pos]</code></td><td>访问 <code>b</code> 中位置 <code>pos</code> 处的位；如果 <code>b</code> 是 <code>const</code> 的，则当该位置位时，返回 <code>true</code> ；否则返回 <code>false</code> 。</td></tr><tr><td><code>b.to_ulong()</code></td><td>返回一个 <code>unsigned long</code> 值，其位模式和 <code>b</code> 相同。如果 <code>b</code> 中位模式不能放入指定的结果类型，则抛出一个 <code>overflow_error</code> 异常。</td></tr><tr><td><code>b.to_ullong()</code></td><td>类似上面，返回一个 <code>unsigned long long</code> 值。</td></tr><tr><td><code>b.to_string(zero, one)</code></td><td>返回一个 <code>string</code> ，表示 <code>b</code> 中位模式。 <code>zero</code> 和 <code>one</code> 默认为 0 和 1。</td></tr><tr><td><code>os &lt;&lt; b</code></td><td>将 <code>b</code> 中二进制位打印为字符 <code>1</code> 或 <code>0</code> ，打印到流 <code>os</code> 。</td></tr><tr><td><code>is &gt;&gt; b</code></td><td>从 <code>is</code> 读取字符存入 <code>b</code> 。当下一个字符不是 1 或 0 时，或是已经读入 <code>b.size()</code> 个位时，读取过程停止。</td></tr></tbody></table><hr><h3 id="exercise-179"><a class="anchor" href="#exercise-179">#</a> Exercise 17.9</h3><blockquote><p>解释下列每个 <code>bitset</code> 对象所包含的位模式：</p></blockquote><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">(</span>a<span class="token punctuation">)</span> bitset<span class="token operator">&lt;</span><span class="token number">64</span><span class="token operator">></span> <span class="token function">bitvec</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 0000000000000000000000000000000000000000000000000000000000100000</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">(</span>b<span class="token punctuation">)</span> bitset<span class="token operator">&lt;</span><span class="token number">32</span><span class="token operator">></span> <span class="token function">bv</span><span class="token punctuation">(</span><span class="token number">1010101</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 00000000000011110110100110110101</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">(</span>c<span class="token punctuation">)</span> string bstr<span class="token punctuation">;</span> cin <span class="token operator">>></span> bstr<span class="token punctuation">;</span> bitset<span class="token operator">&lt;</span><span class="token number">8</span><span class="token operator">></span> <span class="token function">bv</span><span class="token punctuation">(</span>bstr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 根据输入的 str 转换成 bitset</span></pre></td></tr></table></figure><h3 id="exercise-1710"><a class="anchor" href="#exercise-1710">#</a> Exercise 17.10</h3><blockquote><p>使用序列 1、2、3、5、8、13、21 初始化一个 <code>bitset</code> ，将这些位置置位。对另一个 <code>bitset</code> 进行默认初始化，并编写一小段程序将其恰当的位置位。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bitset></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">21</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    std<span class="token double-colon punctuation">::</span>bitset<span class="token operator">&lt;</span><span class="token number">32</span><span class="token operator">></span> bset<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v<span class="token punctuation">)</span>    bset<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    std<span class="token double-colon punctuation">::</span>bitset<span class="token operator">&lt;</span><span class="token number">32</span><span class="token operator">></span> bset2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        bset2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> bset<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span>bset <span class="token operator">&lt;&lt;</span>std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span>bset2<span class="token operator">&lt;&lt;</span>std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1711"><a class="anchor" href="#exercise-1711">#</a> Exercise 17.11</h3><blockquote><p>定义一个数据结构，包含一个整型对象，记录一个包含 10 个问题的真 / 假测验的解答。如果测验包含 100 道题，你需要对数据结构做出什么改变（如果需要的话）？</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bitset></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;utility></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">//class Quiz</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>size_t N<span class="token operator">></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Quiz</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token comment">//constructors</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token function">Quiz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token function">Quiz</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">bitquiz</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token comment">//generate grade</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>size_t M<span class="token operator">></span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">friend</span> std<span class="token double-colon punctuation">::</span>size_t <span class="token function">grade</span><span class="token punctuation">(</span>Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">,</span> Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token comment">//print</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>size_t M<span class="token operator">></span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">friend</span> std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token comment">//update bitset</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>pair<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>size_t<span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    std<span class="token double-colon punctuation">::</span>bitset<span class="token operator">&lt;</span>N<span class="token operator">></span> bitquiz<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>size_t N<span class="token operator">></span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">Quiz</span><span class="token operator">&lt;</span>N<span class="token operator">></span><span class="token double-colon punctuation">::</span><span class="token function">update</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>pair<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>size_t<span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token operator">></span> pair<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    bitquiz<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>pair<span class="token punctuation">.</span>first<span class="token punctuation">,</span> pair<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>size_t M<span class="token operator">></span></pre></td></tr><tr><td data-num="38"></td><td><pre>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> quiz<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    os <span class="token operator">&lt;&lt;</span> quiz<span class="token punctuation">.</span>bitquiz<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">return</span> os<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>size_t M<span class="token operator">></span></pre></td></tr><tr><td data-num="45"></td><td><pre>std<span class="token double-colon punctuation">::</span>size_t <span class="token function">grade</span><span class="token punctuation">(</span>Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> corAns<span class="token punctuation">,</span> Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> stuAns<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">auto</span> result <span class="token operator">=</span> stuAns<span class="token punctuation">.</span>bitquiz <span class="token operator">^</span> corAns<span class="token punctuation">.</span>bitquiz<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    result<span class="token punctuation">.</span><span class="token function">flip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token comment">//Ex17_11</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    std<span class="token double-colon punctuation">::</span>string s <span class="token operator">=</span> <span class="token string">"1010101"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    Quiz<span class="token operator">&lt;</span><span class="token number">10</span><span class="token operator">></span> <span class="token function">quiz</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> quiz <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token comment">//EX17_12</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    quiz<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">make_pair</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> quiz <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token comment">//Ex17_13</span></pre></td></tr><tr><td data-num="65"></td><td><pre>    std<span class="token double-colon punctuation">::</span>string answer <span class="token operator">=</span> <span class="token string">"10011"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    std<span class="token double-colon punctuation">::</span>string stu_answer <span class="token operator">=</span> <span class="token string">"11001"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    Quiz<span class="token operator">&lt;</span><span class="token number">5</span><span class="token operator">></span> <span class="token function">ans</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">stu_ans</span><span class="token punctuation">(</span>stu_answer<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">grade</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> stu_ans<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1712"><a class="anchor" href="#exercise-1712">#</a> Exercise 17.12</h3><blockquote><p>使用前一题中的数据结构，编写一个函数，它接受一个问题编号和一个表示真 / 假解答的值，函数根据这两个参数更新测验的解答。</p></blockquote><p>解：</p><p>参考 17.11。</p><h3 id="exercise-1713"><a class="anchor" href="#exercise-1713">#</a> Exercise 17.13</h3><blockquote><p>编写一个整型对象，包含真 / 假测验的正确答案。使用它来为前两题中的数据结构生成测验成绩。</p></blockquote><p>解：</p><p>参考 17.11。</p><h2 id="regular-expressions"><a class="anchor" href="#regular-expressions">#</a> Regular Expressions</h2><hr><h3 id="正则表达式"><a class="anchor" href="#正则表达式">#</a> 正则表达式</h3><ul><li>正则表达式（reqular expression）是一种描述字符序列的方法，是一种很强大的工具。</li></ul><p>正则表达式库组件：</p><table><thead><tr><th>组件</th><th>解释</th></tr></thead><tbody><tr><td><code>regex</code></td><td>表示一个正则表达式的类</td></tr><tr><td><code>regex_match</code></td><td>将一个字符序列与一个正则表达式匹配</td></tr><tr><td><code>regex_search</code></td><td>寻找第一个与正则表达式匹配的子序列</td></tr><tr><td><code>regex_replace</code></td><td>使用给定格式替换一个正则表达式</td></tr><tr><td><code>sregex_iterator</code></td><td>迭代器适配器，调用 <code>regex_searcg</code> 来遍历一个 <code>string</code> 中所有匹配的子串</td></tr><tr><td><code>smatch</code></td><td>容器类，保存在 <code>string</code> 中搜索的结果</td></tr><tr><td><code>ssub_match</code></td><td><code>string</code> 中匹配的子表达式的结果</td></tr></tbody></table><p><code>regex_match</code> 和 <code>regex_search</code> 的参数：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>(seq, m, r, mft)</code></td><td>在字符序列 <code>seq</code> 中查找 <code>regex</code> 对象 <code>r</code> 中的正则表达式。 <code>seq</code> 可以是一个 <code>string</code> 、标识范围的一对迭代器、一个指向空字符结尾的字符数组的指针。</td></tr><tr><td><code>(seq, r, mft)</code></td><td><code>m</code> 是一个 <code>match</code> 对象，用来保存匹配结果的相关细节。 <code>m</code> 和 <code>seq</code> 必须具有兼容的类型。 <code>mft</code> 是一个可选的 <code>regex_constants::match_flag_type</code> 值。</td></tr></tbody></table><ul><li>这些操作会返回 <code>bool</code> 值，指出是否找到匹配。</li></ul><h4 id="使用正则表达式库"><a class="anchor" href="#使用正则表达式库">#</a> 使用正则表达式库</h4><ul><li><code>regex</code> 使用的正则表达式语言是 <code>ECMAScript</code> ，模式 <code>[[::alpha::]]</code> 匹配任意字母。</li><li>由于反斜线是 C<ins> 中的特殊字符，在模式中每次出现 <code>\</code> 的地方，必须用一个额外的反斜线 <code>\\</code> 告知 C</ins> 我们需要一个反斜线字符。</li><li>简单案例：<ul><li><code>string pattern(&quot;[^c]ei&quot;); pattern = &quot;[[:alpha:]]*&quot; + pattern + &quot;[[:alpha:]]*&quot;</code> 查找不在字符 c 之后的字符串 ei</li><li><code>regex r(pattern);</code> 构造一个用于查找模式的 regex</li><li><code>smatch results;</code> 定义一个对象保存搜索结果</li><li><code>string test_str = &quot;receipt freind theif receive&quot;;</code></li><li><code>if (regex_search(test_str, results, r)) cout &lt;&lt; results.str() &lt;&lt; endl;</code> 如有匹配子串，打印匹配的单词。</li></ul></li></ul><p><code>regex</code> （和 <code>wregex</code> ）选项：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>regex r(re)</code> <code>regex r(re, f)</code></td><td><code>re</code> 表示一个正则表达式，它可以是一个 <code>string</code> 、一对表示字符范围的迭代器、一个指向空字符结尾的字符数组的指针、一个字符指针和一个计数器、一个花括号包围的字符列表。 <code>f</code> 是指出对象如何处理的标志。 <code>f</code> 通过下面列出来的值来设置。如果未指定 <code>f</code> ，其默认值为 <code>ECMAScript</code> 。</td></tr><tr><td><code>r1 = re</code></td><td>将 <code>r1</code> 中的正则表达式替换 Wie <code>re</code> 。 <code>re</code> 表示一个正则表达式，它可以是另一个 <code>regex</code> 对象、一个 <code>string</code> 、一个指向空字符结尾的字符数组的指针或是一个花括号包围的字符列表。</td></tr><tr><td><code>r1.assign(re, f)</code></td><td>和使用赋值运算符（=）的效果相同：可选的标志 <code>f</code> 也和 <code>regex</code> 的构造函数中对应的参数含义相同。</td></tr><tr><td><code>r.mark_count()</code></td><td><code>r</code> 中子表达式的数目</td></tr><tr><td><code>r.flags()</code></td><td>返回 <code>r</code> 的标志集</td></tr></tbody></table><p>定义 <code>regex</code> 时指定的标志：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>icase</code></td><td>在匹配过程中忽略大小写</td></tr><tr><td><code>nosubs</code></td><td>不保存匹配的子表达式</td></tr><tr><td><code>optimize</code></td><td>执行速度优先于构造速度</td></tr><tr><td><code>ECMAScript</code></td><td>使用 <code>ECMA-262</code> 指定的语法</td></tr><tr><td><code>basic</code></td><td>使用 <code>POSIX</code> 基本的正则表达式语法</td></tr><tr><td><code>extended</code></td><td>使用 <code>POSIX</code> 扩展的正则表达式语法</td></tr><tr><td><code>awk</code></td><td>使用 <code>POSIX</code> 版本的 <code>awk</code> 语言的语法</td></tr><tr><td><code>grep</code></td><td>使用 <code>POSIX</code> 版本的 <code>grep</code> 的语法</td></tr><tr><td><code>egrep</code></td><td>使用 <code>POSIX</code> 版本的 <code>egrep</code> 的语法</td></tr></tbody></table><ul><li>可以将正则表达式本身看做是一种简单程序语言设计的程序。在运行时，当一个 <code>regex</code> 对象被初始化或被赋予新模式时，才被 “编译”。</li><li>如果编写的正则表达式存在错误，会在运行时抛出一个 <code>regex_error</code> 的异常。</li><li>避免创建不必要的正则表达式。构建一个 <code>regex</code> 对象可能比较耗时。</li></ul><h4 id="匹配与regex迭代器类型"><a class="anchor" href="#匹配与regex迭代器类型">#</a> 匹配与 regex 迭代器类型</h4><p><code>sregex_iterator</code> 操作（用来获得所有匹配）：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>sregex_iterator it(b, e, r);</code></td><td>一个 <code>sregex_iterator</code> ，遍历迭代器 <code>b</code> 和 <code>e</code> 表示的 <code>string</code> 。它调用 <code>sregex_search(b, e, r)</code> 将 <code>it</code> 定位到输入中第一个匹配的位置。</td></tr><tr><td><code>sregex_iterator end;</code></td><td><code>sregex_iterator</code> 的尾后迭代器</td></tr><tr><td><code>*it</code> ， <code>it-&gt;</code></td><td>根据最后一个调用 <code>regex_search</code> 的结果，返回一个 <code>smatch</code> 对象的引用或一个指向 <code>smatch</code> 对象的指针。</td></tr><tr><td><code>++it</code> ， <code>it++</code></td><td>从输入序列当前匹配位置开始调用 <code>regex_search</code> 。前置版本返回递增后迭代器；后置版本返回旧值。</td></tr><tr><td><code>it1 == it2</code></td><td>如果两个 <code>sregex_iterator</code> 都是尾后迭代器，则它们相等。两个非尾后迭代器是从相同的输入序列和 <code>regex</code> 对象构造，则它们相等。</td></tr></tbody></table><p>示例：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 将字符串 file 中所有匹配模式 r 的子串输出</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span>sregex_iterator <span class="token function">it</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">;</span> it <span class="token operator">!=</span> end_it<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> it <span class="token operator">-></span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><code>smatch</code> 操作：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>m.ready()</code></td><td>如果已经通过调用 <code>regex_search</code> 或 <code>regex_match</code> 设置了 <code>m</code> ，则返回 <code>true</code> ；否则返回 <code>false</code> 。如果 <code>ready</code> 返回 <code>false</code> ，则对 <code>m</code> 进行操作是未定义的。</td></tr><tr><td><code>m.size()</code></td><td>如果匹配失败，则返回 0，；否则返回最近一次匹配的正则表达式中子表达式的数目。</td></tr><tr><td><code>m.empty()</code></td><td>等价于 <code>m.size() == 0</code></td></tr><tr><td><code>m.prefix()</code></td><td>一个 <code>ssub_match</code> 对象，标识当前匹配之前的序列</td></tr><tr><td><code>m.suffix()</code></td><td>一个 <code>ssub_match</code> 对象，标识当前匹配之后的部分</td></tr><tr><td><code>m.format(...)</code></td><td></td></tr><tr><td><code>m.length(n)</code></td><td>第 <code>n</code> 个匹配的子表达式的大小</td></tr><tr><td><code>m.position(n)</code></td><td>第 <code>n</code> 个子表达式距离序列开始的长度</td></tr><tr><td><code>m.str(n)</code></td><td>第 <code>n</code> 个子表达式匹配的 <code>string</code></td></tr><tr><td><code>m[n]</code></td><td>对应第 <code>n</code> 个子表达式的 <code>ssub_match</code> 对象</td></tr><tr><td><code>m.begin(), m.end()</code></td><td>表示 <code>m</code> 中 <code>ssub_match</code> 元素范围的迭代器。</td></tr><tr><td><code>m.cbegin(), m.cend()</code></td><td>常量迭代器</td></tr></tbody></table><h4 id="使用子表达式"><a class="anchor" href="#使用子表达式">#</a> 使用子表达式</h4><ul><li>正则表达式语法通常用括号表示子表达式。</li><li>子表达式的索引从 1 开始。</li><li>在 <code>fmt</code> 中用 <code>$</code> 后跟子表达式的索引号来标识一个特定的子表达式。</li></ul><p>示例：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">regex_search</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> results<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> results<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>  <span class="token comment">//.str (1) 获取第一个子表达式匹配结果</span></pre></td></tr></table></figure><p><code>ssub_match</code> 子匹配操作：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>matched</code></td><td>一个 <code>public bool</code> 数据成员，指出 <code>ssub_match</code> 是否匹配了</td></tr><tr><td><code>first</code> ， <code>second</code></td><td><code>public</code> 数据成员，指向匹配序列首元素和尾后位置的迭代器。如果未匹配，则 <code>first</code> 和 <code>second</code> 是相等的。</td></tr><tr><td><code>length()</code></td><td>匹配的大小，如果 <code>matched</code> 为 <code>false</code> ，则返回 0。</td></tr><tr><td><code>str()</code></td><td>返回一个包含输入中匹配部分的 <code>string</code> 。如果 <code>matched</code> 为 <code>false</code> ，则返回空 <code>string</code> 。</td></tr><tr><td><code>s = ssub</code></td><td>将 <code>ssub_match</code> 对象 <code>ssub</code> 转化为 <code>string</code> 对象 <code>s</code> 。等价于 <code>s=ssub.str()</code> ，转换运算符不是 <code>explicit</code> 的。</td></tr></tbody></table><h4 id="使用regex_replace"><a class="anchor" href="#使用regex_replace">#</a> 使用 regex_replace</h4><p>正则表达式替换操作：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>m.format(dest, fmt, mft)</code> , <code>m.format(fmt, mft)</code></td><td>使用格式字符串 <code>fmt</code> 生成格式化输出，匹配在 <code>m</code> 中，可选的 <code>match_flag_type</code> 标志在 <code>mft</code> 中。第一个版本写入迭代器 <code>dest</code> 指向的目的为止，并接受 <code>fmt</code> 参数，可以是一个 <code>string</code> ，也可以是一个指向空字符结尾的字符数组的指针。 <code>mft</code> 的默认值是 <code>format_default</code> 。</td></tr><tr><td><code>rege_replace(dest, seq, r, fmt, mft)</code> ， <code>regex_replace(seq, r, fmt, mft)</code></td><td>遍历 <code>seq</code> ，用 <code>regex_search</code> 查找与 <code>regex</code> 对象 <code>r</code> 相匹配的子串，使用格式字符串 <code>fmt</code> 和可选的 <code>match_flag_type</code> 标志来生成输出。 <code>mft</code> 的默认值是 <code>match_default</code></td></tr></tbody></table><p>示例：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre>string phone <span class="token operator">=</span> <span class="token string">"(\\()?(\\d&#123;3&#125;)(\\))?([-. ])?(\\d&#123;3&#125;)([-. ]?)(\\d&#123;4&#125;)"</span></pre></td></tr><tr><td data-num="2"></td><td><pre>string fmt <span class="token operator">=</span> <span class="token string">"$2.$5.$7"</span><span class="token punctuation">;</span>  <span class="token comment">// 将号码格式改为 ddd.ddd.dddd</span></pre></td></tr><tr><td data-num="3"></td><td><pre>regex <span class="token function">r</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 用来寻找模式的 regex 对象</span></pre></td></tr><tr><td data-num="4"></td><td><pre>string number <span class="token operator">=</span> <span class="token string">"(908) 555-1800"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>cout <span class="token operator">&lt;&lt;</span> <span class="token function">regex_replace</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> r<span class="token punctuation">,</span> fmt<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr></table></figure><p>匹配标志：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>match_default</code></td><td>等价于 <code>format_default</code></td></tr><tr><td><code>match_not_bol</code></td><td>不将首字符作为行首处理</td></tr><tr><td><code>match_not_eol</code></td><td>不将尾字符作为行尾处理</td></tr><tr><td><code>match_not_bow</code></td><td>不将首字符作为单词首处理</td></tr><tr><td><code>match_not_eow</code></td><td>不将尾字符作为单词尾处理</td></tr><tr><td><code>match_any</code></td><td>如果存在多于一个匹配，则可以返回任意一个匹配</td></tr><tr><td><code>match_not_null</code></td><td>不匹配任何空序列</td></tr><tr><td><code>match_continuous</code></td><td>匹配必须从输入的首字符开始</td></tr><tr><td><code>match_prev_avail</code></td><td>输入序列包含第一个匹配之前的内容</td></tr><tr><td><code>format_default</code></td><td>用 <code>ECMAScript</code> 规则替换字符串</td></tr><tr><td><code>format_sed</code></td><td>用 <code>POSIX sed</code> 规则替换字符串</td></tr><tr><td><code>format_no_copy</code></td><td>不输出输入序列中未匹配的部分</td></tr><tr><td><code>format_first_only</code></td><td>只替换子表达式的第一次出现</td></tr></tbody></table><hr><h3 id="exercise-1714"><a class="anchor" href="#exercise-1714">#</a> Exercise 17.14</h3><blockquote><p>编写几个正则表达式，分别触发不同错误。运行你的程序，观察编译器对每个错误的输出。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>string<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>regex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>regex_error<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token comment">// for ex17.14</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token comment">// error_brack</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        regex <span class="token function">r</span><span class="token punctuation">(</span><span class="token string">"[[:alnum:]+\\.(cpp|cxx|cc)$"</span><span class="token punctuation">,</span> regex<span class="token double-colon punctuation">::</span>icase<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">catch</span><span class="token punctuation">(</span>regex_error e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" code: "</span> <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token comment">// for ex17.15</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    regex <span class="token function">r</span><span class="token punctuation">(</span><span class="token string">"[[:alpha:]]*[^c]ei[[:alpha:]]*"</span><span class="token punctuation">,</span> regex<span class="token double-colon punctuation">::</span>icase<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    string s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a word! Input 'q' to quit!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span>cin <span class="token operator">>></span> s <span class="token operator">&amp;&amp;</span> s <span class="token operator">!=</span> <span class="token string">"q"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">regex_match</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Input word "</span> <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" is okay!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">else</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Input word "</span> <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" is not okay!"</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a word! Input 'q' to quit!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token comment">// for ex17.16</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    r<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token string">"[^c]ei"</span><span class="token punctuation">,</span> regex<span class="token double-colon punctuation">::</span>icase<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a word! Input 'q' to quit!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span>cin <span class="token operator">>></span> s <span class="token operator">&amp;&amp;</span> s <span class="token operator">!=</span> <span class="token string">"q"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">regex_match</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Input word "</span> <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" is okay!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token keyword">else</span></pre></td></tr><tr><td data-num="49"></td><td><pre>            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Input word "</span> <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" is not okay!"</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a word! Input 'q' to quit!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1715"><a class="anchor" href="#exercise-1715">#</a> Exercise 17.15</h3><blockquote><p>编写程序，使用模式查找违反 “i 在 e 之前，除非在 c 之后” 规则的单词。你的程序应该提示用户输入一个单词，然后指出此单词是否符号要求。用一些违反和未违反规则的单词测试你的程序。</p></blockquote><p>解：</p><p>参考 17.14。</p><h3 id="exercise-1716"><a class="anchor" href="#exercise-1716">#</a> Exercise 17.16</h3><blockquote><p>如果前一题程序中的 <code>regex</code> 对象用 <code>&quot;[^c]ei&quot;</code> 进行初始化，将会发生什么？用此模式测试你的程序，检查你的答案是否正确。</p></blockquote><p>解：</p><p>参考 17.14。</p><h3 id="exercise-1717"><a class="anchor" href="#exercise-1717">#</a> Exercise 17.17</h3><blockquote><p>更新你的程序，令它查找输入序列中所有违反 &quot;ei&quot; 语法规则的单词。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>string<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>regex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>sregex_iterator<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	string s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a sequence of words:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>	<span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Word(s) that violiate the \"ei\" grammar rule:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>	string <span class="token function">pattern</span><span class="token punctuation">(</span><span class="token string">"[^c]ei"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	pattern <span class="token operator">=</span> <span class="token string">"[[:alpha:]]*"</span> <span class="token operator">+</span> pattern <span class="token operator">+</span> <span class="token string">"[[:alpha:]]*"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	regex <span class="token function">r</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> regex<span class="token double-colon punctuation">::</span>icase<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span>sregex_iterator <span class="token function">it</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">;</span> it <span class="token operator">!=</span> end_it<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>		cout <span class="token operator">&lt;&lt;</span> it<span class="token operator">-></span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1718"><a class="anchor" href="#exercise-1718">#</a> Exercise 17.18</h3><blockquote><p>修改你的程序，忽略包含 “ei` 但并非拼写错误的单词，如 “albeit” 和 “neighbor”。</p></blockquote><p>解：</p><p>参考 17.17。</p><h3 id="exercise-1719"><a class="anchor" href="#exercise-1719">#</a> Exercise 17.19</h3><blockquote><p>为什么可以不先检查 <code>m[4]</code> 是否匹配了就直接调用 <code>m[4].str()</code> ？</p></blockquote><p>解：</p><p>如果不匹配，则 <code>m[4].str()</code> 返回空字符串。</p><h3 id="exercise-1720"><a class="anchor" href="#exercise-1720">#</a> Exercise 17.20</h3><blockquote><p>编写你自己版本的验证电话号码的程序。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>string<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>regex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>sregex_iterator<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>smatch<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>	string phone <span class="token operator">=</span> <span class="token string">"(\\()?(\\d&#123; 3 &#125;)(\\))?([-. ])?(\\d&#123; 3 &#125;)([-. ]?)(\\d&#123; 4 &#125;)"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	regex <span class="token function">r</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>	smatch m<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	string s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	<span class="token keyword">bool</span> valid_record<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>	<span class="token comment">// read each record from the input file</span></pre></td></tr><tr><td data-num="24"></td><td><pre>	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>		valid_record <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>		<span class="token comment">// for each matching phone number</span></pre></td></tr><tr><td data-num="28"></td><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>sregex_iterator <span class="token function">it</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">;</span> it <span class="token operator">!=</span> end_it<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>			valid_record <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>			<span class="token comment">// check whether the number's formatting is valid</span></pre></td></tr><tr><td data-num="32"></td><td><pre>			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>				cout <span class="token operator">&lt;&lt;</span> <span class="token string">"valid phone number: "</span> <span class="token operator">&lt;&lt;</span> it<span class="token operator">-></span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>			<span class="token keyword">else</span></pre></td></tr><tr><td data-num="35"></td><td><pre>				cout <span class="token operator">&lt;&lt;</span> <span class="token string">"invalid phone number: "</span> <span class="token operator">&lt;&lt;</span> it<span class="token operator">-></span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>valid_record<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>			cout <span class="token operator">&lt;&lt;</span> <span class="token string">"invalid record!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>	<span class="token comment">// if there is an open parenthesis before the area code</span></pre></td></tr><tr><td data-num="47"></td><td><pre>	<span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>		<span class="token comment">// the area code must be followed by a close parenthesis</span></pre></td></tr><tr><td data-num="49"></td><td><pre>		<span class="token comment">// and followed immediately by the rest of the number or a space</span></pre></td></tr><tr><td data-num="50"></td><td><pre>		<span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>	<span class="token keyword">else</span></pre></td></tr><tr><td data-num="52"></td><td><pre>		<span class="token comment">// then there can't be a close after the area code</span></pre></td></tr><tr><td data-num="53"></td><td><pre>		<span class="token comment">// the delimiters between the other two components must match</span></pre></td></tr><tr><td data-num="54"></td><td><pre>		<span class="token keyword">return</span> <span class="token operator">!</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">&amp;&amp;</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> m<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1721"><a class="anchor" href="#exercise-1721">#</a> Exercise 17.21</h3><blockquote><p>使用本节定义的 <code>valid</code> 函数重写 8.3.2 节中的电话号码程序。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cerr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>istream<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>ostream<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>ifstream<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>ofstream<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>istringstream<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>ostringstream<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>string<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>vector<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>regex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>sregex_iterator<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>smatch<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">struct</span> <span class="token class-name">PersonInfo</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    string name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    vector<span class="token operator">&lt;</span>string<span class="token operator">></span> phones<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">bool</span> <span class="token function">read_record</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> is<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span><span class="token operator">&amp;</span> people<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">void</span> <span class="token function">format_record</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span><span class="token operator">&amp;</span> people<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment">// fake function that makes the program compile</span></pre></td></tr><tr><td data-num="39"></td><td><pre>string <span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> num<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span> people<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre>    string filename<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a record file name: "</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    cin <span class="token operator">>></span> filename<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    ifstream <span class="token function">fin</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">read_record</span><span class="token punctuation">(</span>fin<span class="token punctuation">,</span> people<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>        ofstream <span class="token function">fout</span><span class="token punctuation">(</span><span class="token string">"data\\result.txt"</span><span class="token punctuation">,</span> ofstream<span class="token double-colon punctuation">::</span>trunc<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token function">format_record</span><span class="token punctuation">(</span>fout<span class="token punctuation">,</span> people<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Fail to open file "</span> <span class="token operator">&lt;&lt;</span> filename <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token comment">// if there is an open parenthesis before the area code</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        <span class="token comment">// the area code must be followed by a close parenthesis</span></pre></td></tr><tr><td data-num="69"></td><td><pre>        <span class="token comment">// and followed immediately by the rest of the number or a space</span></pre></td></tr><tr><td data-num="70"></td><td><pre>        <span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="72"></td><td><pre>        <span class="token comment">// then there can't be a close after the area code</span></pre></td></tr><tr><td data-num="73"></td><td><pre>        <span class="token comment">// the delimiters between the other two components must match</span></pre></td></tr><tr><td data-num="74"></td><td><pre>        <span class="token keyword">return</span> <span class="token operator">!</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">&amp;&amp;</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> m<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token keyword">bool</span> <span class="token function">read_record</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> is<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span><span class="token operator">&amp;</span> people<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>is<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>        string line<span class="token punctuation">,</span> word<span class="token punctuation">;</span> <span class="token comment">// will hold a line and word from input, respectively</span></pre></td></tr><tr><td data-num="82"></td><td><pre>                           <span class="token comment">// read the input a line at a time until cin hits end-of-file (or another error)</span></pre></td></tr><tr><td data-num="83"></td><td><pre>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="84"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>            PersonInfo info<span class="token punctuation">;</span> <span class="token comment">// create an object to hold this record's data</span></pre></td></tr><tr><td data-num="86"></td><td><pre>            istringstream <span class="token function">record</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bind record to the line we just read</span></pre></td></tr><tr><td data-num="87"></td><td><pre>            record <span class="token operator">>></span> info<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// read the name</span></pre></td></tr><tr><td data-num="88"></td><td><pre>            <span class="token keyword">while</span> <span class="token punctuation">(</span>record <span class="token operator">>></span> word<span class="token punctuation">)</span> <span class="token comment">// read the phone numbers</span></pre></td></tr><tr><td data-num="89"></td><td><pre>                info<span class="token punctuation">.</span>phones<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// and store them</span></pre></td></tr><tr><td data-num="90"></td><td><pre>            people<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// append this record to people</span></pre></td></tr><tr><td data-num="91"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="95"></td><td><pre>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="97"></td><td><pre></pre></td></tr><tr><td data-num="98"></td><td><pre><span class="token keyword">void</span> <span class="token function">format_record</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span><span class="token operator">&amp;</span> people<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="99"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>    string phone <span class="token operator">=</span> <span class="token string">"(\\()?(\\d&#123; 3 &#125;)(\\))?([-. ])?(\\d&#123; 3 &#125;)([-. ]?)(\\d&#123; 4 &#125;)"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>    regex <span class="token function">r</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>    smatch m<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre></pre></td></tr><tr><td data-num="104"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>entry <span class="token operator">:</span> people<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="105"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>        <span class="token comment">// for each entry in people</span></pre></td></tr><tr><td data-num="107"></td><td><pre>        ostringstream formatted<span class="token punctuation">,</span> badNums<span class="token punctuation">;</span> <span class="token comment">// objects created on each loop</span></pre></td></tr><tr><td data-num="108"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>nums <span class="token operator">:</span> entry<span class="token punctuation">.</span>phones<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="109"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>            <span class="token keyword">for</span> <span class="token punctuation">(</span>sregex_iterator <span class="token function">it</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">;</span> it <span class="token operator">!=</span> end_it<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="111"></td><td><pre>            <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>                <span class="token comment">// for each number</span></pre></td></tr><tr><td data-num="113"></td><td><pre>                <span class="token comment">// check whether the number's formatting is valid</span></pre></td></tr><tr><td data-num="114"></td><td><pre>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="115"></td><td><pre>                    <span class="token comment">// string in badNums</span></pre></td></tr><tr><td data-num="116"></td><td><pre>                    badNums <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> nums<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>                <span class="token keyword">else</span></pre></td></tr><tr><td data-num="118"></td><td><pre>                    <span class="token comment">// "writes" to formatted's string</span></pre></td></tr><tr><td data-num="119"></td><td><pre>                    formatted <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">format</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="122"></td><td><pre></pre></td></tr><tr><td data-num="123"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>badNums<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// there were no bad numbers</span></pre></td></tr><tr><td data-num="124"></td><td><pre>            os <span class="token operator">&lt;&lt;</span> entry<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token comment">// print the name</span></pre></td></tr><tr><td data-num="125"></td><td><pre>            <span class="token operator">&lt;&lt;</span> formatted<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">// and reformatted numbers</span></pre></td></tr><tr><td data-num="126"></td><td><pre>        <span class="token keyword">else</span> <span class="token comment">// otherwise, print the name and bad numbers</span></pre></td></tr><tr><td data-num="127"></td><td><pre>            cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"input error: "</span> <span class="token operator">&lt;&lt;</span> entry<span class="token punctuation">.</span>name</pre></td></tr><tr><td data-num="128"></td><td><pre>            <span class="token operator">&lt;&lt;</span> <span class="token string">" invalid number(s) "</span> <span class="token operator">&lt;&lt;</span> badNums<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="130"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1722"><a class="anchor" href="#exercise-1722">#</a> Exercise 17.22</h3><blockquote><p>重写你的电话号码程序，使之允许在号码的三个部分之间放置任意多个空白符。</p></blockquote><p>解：</p><p>参考 17.21。</p><h3 id="exercise-1723"><a class="anchor" href="#exercise-1723">#</a> Exercise 17.23</h3><blockquote><p>编写查找邮政编码的正则表达式。一个美国邮政编码可以由五位或九位数字组成。前五位数字和后四位数字之间可以用一个短横线分隔。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>string<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>regex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>sregex_iterator<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>smatch<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>	string zipcode <span class="token operator">=</span></pre></td></tr><tr><td data-num="19"></td><td><pre>		<span class="token string">"(\\d&#123;5&#125;)([-])?(\\d&#123;4&#125;)?\\b"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>	regex <span class="token function">r</span><span class="token punctuation">(</span>zipcode<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	smatch m<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	string s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>	</pre></td></tr><tr><td data-num="24"></td><td><pre>	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>		<span class="token comment">//! for each matching zipcode number</span></pre></td></tr><tr><td data-num="28"></td><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span>sregex_iterator <span class="token function">it</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>			it <span class="token operator">!=</span> end_it<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>			<span class="token comment">//! check whether the number's formatting is valid</span></pre></td></tr><tr><td data-num="32"></td><td><pre>			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>				cout <span class="token operator">&lt;&lt;</span> <span class="token string">"valid zipcode number: "</span> <span class="token operator">&lt;&lt;</span> it<span class="token operator">-></span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>			<span class="token keyword">else</span></pre></td></tr><tr><td data-num="35"></td><td><pre>				cout <span class="token operator">&lt;&lt;</span> <span class="token string">"invalid zipcode number: "</span> <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>	</pre></td></tr><tr><td data-num="45"></td><td><pre>	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token operator">!</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre>		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>	<span class="token keyword">else</span></pre></td></tr><tr><td data-num="48"></td><td><pre>		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1724"><a class="anchor" href="#exercise-1724">#</a> Exercise 17.24</h3><blockquote><p>编写你自己版本的重拍电话号码格式的程序。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>string pattern <span class="token operator">=</span> <span class="token string">"(\\()?(\\d&#123;3&#125;)(\\))?([-. ])?(\\d&#123;3&#125;)([-. ])?(\\d&#123;4&#125;)"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>string format <span class="token operator">=</span> <span class="token string">"$2.$5.$7"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>regex <span class="token function">r</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>string s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        cout<span class="token operator">&lt;&lt;</span><span class="token function">regex_replace</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>r<span class="token punctuation">,</span>format<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1725"><a class="anchor" href="#exercise-1725">#</a> Exercise 17.25</h3><blockquote><p>重写你的电话号码程序，使之只输出每个人的第一个电话号码。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>string pattern <span class="token operator">=</span> <span class="token string">"(\\()?(\\d&#123;3&#125;)(\\))?([-. ])?(\\d&#123;3&#125;)([-. ])?(\\d&#123;4&#125;)"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>string fmt <span class="token operator">=</span> <span class="token string">"$2.$5.$7"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>regex <span class="token function">r</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>string s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        smatch result<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token function">regex_search</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>result<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        cout<span class="token operator">&lt;&lt;</span>result<span class="token punctuation">.</span><span class="token function">prefix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>result<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>fmt<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">else</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"Sorry, No match."</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1726"><a class="anchor" href="#exercise-1726">#</a> Exercise 17.26</h3><blockquote><p>重写你的电话号码程序，使之对多于一个电话号码的人只输出第二个和后续号码。</p></blockquote><p>解：</p><p>略</p><h3 id="exercise-1727"><a class="anchor" href="#exercise-1727">#</a> Exercise 17.27</h3><blockquote><p>编写程序，将九位数字邮政编码的格式转换为 <code>ddddd-dddd</code> 。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>string pattern <span class="token operator">=</span> <span class="token string">"(\\d&#123;5&#125;)([.- ])?(\\d&#123;4&#125;)"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>string fmt <span class="token operator">=</span> <span class="token string">"$1-$3"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>regex <span class="token function">r</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>string s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        smatch result<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token function">regex_search</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>result<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span>result<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>fmt<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">else</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"Sorry, No match."</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="random-numbers"><a class="anchor" href="#random-numbers">#</a> Random Numbers</h2><hr><h3 id="随机数"><a class="anchor" href="#随机数">#</a> 随机数</h3><ul><li>新标准之前，C 和 C++ 都依赖一个简单的 C 库函数 <code>rand</code> 来生成随机数，且只符合均匀分布。</li><li>新标准：<strong>随机数引擎</strong> + <strong>随机数分布类</strong>， 定义在 <code>random</code> 头文件中。</li><li>C++ 程序应该使用 <code>default_random_engine</code> 类和恰当的分布类对象。</li></ul><h4 id="随机数引擎和分布"><a class="anchor" href="#随机数引擎和分布">#</a> 随机数引擎和分布</h4><p>随机数引擎操作</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>Engine e;</code></td><td>默认构造函数；使用该引擎类型默认的种子</td></tr><tr><td><code>Engine e(s);</code></td><td>使用整型值 <code>s</code> 作为种子</td></tr><tr><td><code>e.seed(s)</code></td><td>使用种子 <code>s</code> 重置引擎的状态</td></tr><tr><td><code>e.min()</code> ， <code>e.max()</code></td><td>此引擎可生成的最小值和最大值</td></tr><tr><td><code>Engine::result_type</code></td><td>此引擎生成的 <code>unsigned</code> 整型类型</td></tr><tr><td><code>e.discard(u)</code></td><td>将引擎推进 <code>u</code> 步； <code>u</code> 的类型为 <code>unsigned long long</code></td></tr></tbody></table><p>示例：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 初始化分布类型</span></pre></td></tr><tr><td data-num="2"></td><td><pre>uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">></span> <span class="token function">u</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 初始化引擎</span></pre></td></tr><tr><td data-num="4"></td><td><pre>default_random_engine e<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 随机生成 0-9 的无符号整数</span></pre></td></tr><tr><td data-num="6"></td><td><pre>cout <span class="token operator">&lt;&lt;</span> <span class="token function">u</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>设置随机数发生器种子</strong>：</p><ul><li>种子就是一个数值，引擎可以利用它从序列中一个新位置重新开始生成随机数。</li><li>种子可以使用系统函数 <code>time(0)</code> 。</li></ul><h4 id="其他随机数分布"><a class="anchor" href="#其他随机数分布">#</a> 其他随机数分布</h4><p>分布类型的操作：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>Dist d;</code></td><td>默认够赞函数；使 <code>d</code> 准备好被使用。其他构造函数依赖于 <code>Dist</code> 的类型；分布类型的构造函数是 <code>explicit</code> 的。</td></tr><tr><td><code>d(e)</code></td><td>用相同的 <code>e</code> 连续调用 <code>d</code> 的话，会根据 <code>d</code> 的分布式类型生成一个随机数序列； <code>e</code> 是一个随机数引擎对象。</td></tr><tr><td><code>d.min()</code> , <code>d.max()</code></td><td>返回 <code>d(e)</code> 能生成的最小值和最大值。</td></tr><tr><td><code>d.reset()</code></td><td>重建 <code>d</code> 的状态，是的随后对 <code>d</code> 的使用不依赖于 <code>d</code> 已经生成的值。</td></tr></tbody></table><hr><h3 id="exercise-1728"><a class="anchor" href="#exercise-1728">#</a> Exercise 17.28</h3><blockquote><p>编写函数，每次调用生成并返回一个均匀分布的随机 <code>unsigned int</code> 。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;random></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// default version</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// with seed spicified</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> seed<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// with seed and range spicified</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> seed<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> min<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    std<span class="token double-colon punctuation">::</span>string temp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>cin <span class="token operator">>></span> temp<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>hex <span class="token operator">&lt;&lt;</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">static</span> std<span class="token double-colon punctuation">::</span>default_random_engine e<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">static</span> std<span class="token double-colon punctuation">::</span>uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">></span> ud<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">ud</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> seed<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">static</span> std<span class="token double-colon punctuation">::</span>default_random_engine <span class="token function">e</span><span class="token punctuation">(</span>seed<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">static</span> std<span class="token double-colon punctuation">::</span>uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">></span> ud<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">ud</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> seed<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> min<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> max<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">static</span> std<span class="token double-colon punctuation">::</span>default_random_engine <span class="token function">e</span><span class="token punctuation">(</span>seed<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">static</span> std<span class="token double-colon punctuation">::</span>uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">></span> <span class="token function">ud</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">ud</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1729"><a class="anchor" href="#exercise-1729">#</a> Exercise 17.29</h3><blockquote><p>修改上一题中编写的函数，允许用户提供一个种子作为可选参数。</p></blockquote><p>解：</p><p>参考 17.28。</p><h3 id="exercise-1730"><a class="anchor" href="#exercise-1730">#</a> Exercise 17.30</h3><blockquote><p>再次修改你的程序，此次增加两个参数，表示函数允许返回的最小值和最大值。</p></blockquote><p>解：</p><p>参考 17.28。</p><h3 id="exercise-1731"><a class="anchor" href="#exercise-1731">#</a> Exercise 17.31</h3><blockquote><p>对于本节中的游戏程序，如果在 <code>do</code> 循环内定义 <code>b</code> 和 <code>e</code> ，会发生什么？</p></blockquote><p>解：</p><p>由于引擎返回相同的随机数序列，因此眉不循环都会创建新的引擎，眉不循环都会生成相同的值。</p><h3 id="exercise-1732"><a class="anchor" href="#exercise-1732">#</a> Exercise 17.32</h3><blockquote><p>如果我们在循环内定义 <code>resp</code> ，会发生什么？</p></blockquote><p>解：</p><p>会报错， <code>while</code> 条件中用到了 <code>resp</code> 。</p><h3 id="exercise-1733"><a class="anchor" href="#exercise-1733">#</a> Exercise 17.33</h3><blockquote><p>修改 11.3.6 节中的单词转换程序，允许对一个给定单词有多种转换方式，每次随机选择一种进行实际转换。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>ifstream<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>string<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>vector<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;random></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>default_random_engine<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>uniform_int_distribution<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ctime></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>time<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>sort<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>find_if<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;utility></span></span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>pair<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>	<span class="token keyword">typedef</span> pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> ps<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>	ifstream <span class="token function">i</span><span class="token punctuation">(</span><span class="token string">"d.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>	vector<span class="token operator">&lt;</span>ps<span class="token operator">></span> dict<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>	string str1<span class="token punctuation">,</span> str2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>	<span class="token comment">// read wirds from dictionary</span></pre></td></tr><tr><td data-num="35"></td><td><pre>	<span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">>></span> str1 <span class="token operator">>></span> str2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>		dict<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>str1<span class="token punctuation">,</span> str2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>	i<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>	<span class="token comment">// sort words in vector</span></pre></td></tr><tr><td data-num="40"></td><td><pre>	<span class="token function">sort</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dict<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> ps <span class="token operator">&amp;</span>_ps1<span class="token punctuation">,</span> <span class="token keyword">const</span> ps <span class="token operator">&amp;</span>_ps2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token keyword">return</span> _ps1<span class="token punctuation">.</span>first <span class="token operator">&lt;</span> _ps2<span class="token punctuation">.</span>first<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>	i<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"i.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>	default_random_engine <span class="token function">e</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>	<span class="token comment">// read words from text</span></pre></td></tr><tr><td data-num="44"></td><td><pre>	<span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">>></span> str1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>	  <span class="token comment">// find word in dictionary</span></pre></td></tr><tr><td data-num="46"></td><td><pre>		vector<span class="token operator">&lt;</span>ps<span class="token operator">></span><span class="token double-colon punctuation">::</span>const_iterator it <span class="token operator">=</span> <span class="token function">find_if</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dict<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="47"></td><td><pre>		  <span class="token punctuation">[</span><span class="token operator">&amp;</span>str1<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> ps <span class="token operator">&amp;</span>_ps<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token keyword">return</span> _ps<span class="token punctuation">.</span>first <span class="token operator">==</span> str1<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>		<span class="token comment">// if word doesn't exist in dictionary</span></pre></td></tr><tr><td data-num="49"></td><td><pre>		<span class="token keyword">if</span> <span class="token punctuation">(</span>it <span class="token operator">==</span> dict<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>		  <span class="token comment">// write it itself</span></pre></td></tr><tr><td data-num="51"></td><td><pre>			cout <span class="token operator">&lt;&lt;</span> str1 <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>		<span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>		  <span class="token comment">// get random meaning of word </span></pre></td></tr><tr><td data-num="55"></td><td><pre>			uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">></span> <span class="token function">u</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">find_if</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dict<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="56"></td><td><pre>			 <span class="token punctuation">[</span><span class="token operator">&amp;</span>str1<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> ps <span class="token operator">&amp;</span>_ps<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token keyword">return</span> _ps<span class="token punctuation">.</span>first <span class="token operator">></span> str1<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">-</span> it <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>			<span class="token comment">// write random meaning</span></pre></td></tr><tr><td data-num="58"></td><td><pre>			cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>it <span class="token operator">+</span> <span class="token function">u</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span>second <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="the-io-library-revisited"><a class="anchor" href="#the-io-library-revisited">#</a> The IO Library Revisited</h2><hr><h3 id="io库再探"><a class="anchor" href="#io库再探">#</a> IO 库再探</h3><h4 id="格式化输入与输出"><a class="anchor" href="#格式化输入与输出">#</a> 格式化输入与输出</h4><ul><li>使用操纵符改变格式状态。</li><li>控制布尔值的格式： <code>cout &lt;&lt; boolalpha &lt;&lt; true &lt;&lt; endl;</code></li><li>指定整型的进制： <code>cout &lt;&lt; dec &lt;&lt; 20 &lt;&lt; endl;</code></li></ul><p>定义在 <code>iostream</code> 中的操纵符：</p><table><thead><tr><th>操纵符</th><th>解释</th></tr></thead><tbody><tr><td><code>boolalpha</code></td><td>将 <code>true</code> 和 <code>false</code> 输出为字符串</td></tr><tr><td><code>* noboolalpha</code></td><td>将 <code>true</code> 和 <code>false</code> 输出为 1,0</td></tr><tr><td><code>showbase</code></td><td>对整型值输出表示进制的前缀</td></tr><tr><td><code>* noshowbase</code></td><td>不生成表示进制的前缀</td></tr><tr><td><code>showpoint</code></td><td>对浮点值总是显示小数点</td></tr><tr><td><code>* noshowpoint</code></td><td>只有当浮点值包含小数部分时才显示小数点</td></tr><tr><td><code>showpos</code></td><td>对非负数显示 <code>+</code></td></tr><tr><td><code>* noshowpos</code></td><td>对非负数不显示 <code>+</code></td></tr><tr><td><code>uppercase</code></td><td>在十六进制中打印 <code>0X</code> ，在科学计数法中打印 <code>E</code></td></tr><tr><td><code>* nouppercase</code></td><td>在十六进制中打印 <code>0x</code> ，在科学计数法中打印 <code>e</code></td></tr><tr><td><code>* dec</code></td><td>整型值显示为十进制</td></tr><tr><td><code>hex</code></td><td>整型值显示为十六进制</td></tr><tr><td><code>oct</code></td><td>整型值显示为八进制</td></tr><tr><td><code>left</code></td><td>在值的右侧添加填充字符</td></tr><tr><td><code>right</code></td><td>在值的左侧添加填充字符</td></tr><tr><td><code>internal</code></td><td>在符号和值之间添加填充字符</td></tr><tr><td><code>fixed</code></td><td>浮点值显示为定点十进制</td></tr><tr><td><code>scientific</code></td><td>浮点值显示为科学计数法</td></tr><tr><td><code>hexfloat</code></td><td>浮点值显示为十六进制（C++11）</td></tr><tr><td><code>defaultfloat</code></td><td>充值浮点数格式为十进制（C++11）</td></tr><tr><td><code>unitbuf</code></td><td>每次输出操作后都刷新缓冲区</td></tr><tr><td>1</td><td><code>* nounitbuf</code></td></tr><tr><td><code>* skipws</code></td><td>输入运算符跳过空白符</td></tr><tr><td><code>noskipws</code></td><td>输入运算符不跳过空白符</td></tr><tr><td><code>flush</code></td><td>刷新 <code>ostream</code> 缓冲区</td></tr><tr><td><code>ends</code></td><td>插入空字符，然后刷新 <code>ostream</code> 缓冲区</td></tr><tr><td><code>endl</code></td><td>插入换行，然后刷新 <code>ostream</code> 缓冲区</td></tr></tbody></table><p>其中 <code>*</code> 表示默认的流状态。</p><h4 id="未格式化的输入输出操作"><a class="anchor" href="#未格式化的输入输出操作">#</a> 未格式化的输入 / 输出操作</h4><p>单字节低层 IO 操作：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>is.get(ch)</code></td><td>从 <code>istream is</code> 读取下一个字节存入字符 <code>cn</code> 中。返回 <code>is</code> 。</td></tr><tr><td><code>os.put(ch)</code></td><td>将字符 <code>ch</code> 输出到 <code>ostream os</code> 。返回 <code>os</code> 。</td></tr><tr><td><code>is.get()</code></td><td>将 <code>is</code> 的下一个字节作为 <code>int</code> 返回</td></tr><tr><td><code>is.putback(ch)</code></td><td>将字符 <code>ch</code> 放回 <code>is</code> 。返回 <code>is</code> 。</td></tr><tr><td><code>is.unget()</code></td><td>将 <code>is</code> 向后移动一个字节。返回 <code>is</code> 。</td></tr><tr><td><code>is.peek()</code></td><td>将下一个字节作为 <code>int</code> 返回，但不从流中删除它。</td></tr></tbody></table><p>多字节低层 IO 操作：</p><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>is.get(sink, size, delim)</code></td><td>从 <code>is</code> 中读取最多 <code>size</code> 个字节，并保存在字符数组中，字符数组的起始地址由 <code>sink</code> 给出。读取过程直到遇到字符 <code>delim</code> 或读取了 <code>size</code> 个字节或遇到文件尾时停止。如果遇到了 <code>delim</code> ，则将其留在输入流中，不读取出来存入 <code>sink</code> 。</td></tr><tr><td><code>is.getline(sink, size, delim)</code></td><td>与接收三个参数的 <code>get</code> 版本类似，但会读取并丢弃 <code>delim</code> 。</td></tr><tr><td><code>is.read(sink, size)</code></td><td>读取最多 <code>size</code> 个字节，存入字符数组 <code>sink</code> 中。返回 <code>is</code> 。</td></tr><tr><td><code>is.gcount()</code></td><td>返回上一个未格式化读取从 <code>is</code> 读取的字节数</td></tr><tr><td><code>os.write(source, size)</code></td><td>将字符数组 <code>source</code> 中的 <code>size</code> 个字节写入 <code>os</code> 。返回 <code>os</code> 。</td></tr><tr><td><code>is.ignore(size, delim)</code></td><td>读取并忽略最多 <code>size</code> 个字符，包括 <code>delim</code> 。与其他未格式化函数不同， <code>ignore</code> 有默认参数： <code>size</code> 默认值是 1， <code>delim</code> 的默认值为文件尾。</td></tr></tbody></table><ul><li>注意：一般情况下，主张使用标准库提供的高层抽象，低层函数容易出错。</li></ul><h4 id="流随机访问"><a class="anchor" href="#流随机访问">#</a> 流随机访问</h4><ul><li>只适用于 <code>fstream</code> 和 <code>sstream</code> 。</li><li>通过将标记 <code>seek</code> 到一个给定位置来重定位它。</li><li><code>tell</code> 告诉我们标记的当前位置。</li></ul><table><thead><tr><th>操作</th><th>解释</th></tr></thead><tbody><tr><td><code>tellg()</code> ， <code>tellp</code></td><td>返回一个输入流中（ <code>tellg</code> ）或输出流中（ <code>tellp</code> ）标记的当前位置。</td></tr><tr><td><code>seekg(pos)</code> ， <code>seekp(pos)</code></td><td>在一个输入流或输出流中将标记重定位到给定的绝对地址。 <code>pos</code> 通常是一个当前 <code>teelg</code> 或 <code>tellp</code> 返回的值。</td></tr><tr><td><code>seekp(off, from)</code> ， <code>seekg(off, from)</code></td><td>在一个输入流或输出流中将标记定位到 <code>from</code> 之前或之后 <code>off</code> 个字符， <code>from</code> 可以是下列值之一： <code>beg</code> ，偏移量相对于流开始位置； <code>cur</code> ，偏移量相对于流当前位置； <code>end</code> ，偏移量相对于流结尾位置。</td></tr></tbody></table><hr><h3 id="exercise-1734"><a class="anchor" href="#exercise-1734">#</a> Exercise 17.34</h3><blockquote><p>编写一个程序，展示如何使用表 17.17 和表 17.18 中的每个操作符。</p></blockquote><p>解：</p><p>略</p><h3 id="exercise-1735"><a class="anchor" href="#exercise-1735">#</a> Exercise 17.35</h3><blockquote><p>修改第 670 页中的程序，打印 2 的平方根，但这次打印十六进制数字的大写形式。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iomanip></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	cout <span class="token operator">&lt;&lt;</span><span class="token string">"default format: "</span> <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span></pre></td></tr><tr><td data-num="9"></td><td><pre>		<span class="token operator">&lt;&lt;</span> <span class="token string">"scientific: "</span> <span class="token operator">&lt;&lt;</span> scientific <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		<span class="token operator">&lt;&lt;</span> <span class="token string">"fixed decimal: "</span> <span class="token operator">&lt;&lt;</span> fixed <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span></pre></td></tr><tr><td data-num="11"></td><td><pre>		<span class="token operator">&lt;&lt;</span> <span class="token string">"hexidecimal: "</span> <span class="token operator">&lt;&lt;</span> uppercase <span class="token operator">&lt;&lt;</span> hexfloat <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span></pre></td></tr><tr><td data-num="12"></td><td><pre>		<span class="token operator">&lt;&lt;</span> <span class="token string">"use defaults: "</span> <span class="token operator">&lt;&lt;</span> defaultfloat <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>		<span class="token operator">&lt;&lt;</span> <span class="token string">"\n\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">//17.36</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">//Modify the program from the previous exercise to print the various floating-point values so that they line up in a column.</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iomanip></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>	cout <span class="token operator">&lt;&lt;</span>left<span class="token operator">&lt;&lt;</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"default format:"</span> <span class="token operator">&lt;&lt;</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span> right<span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span></pre></td></tr><tr><td data-num="26"></td><td><pre>	<span class="token operator">&lt;&lt;</span> left <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"scientific:"</span> <span class="token operator">&lt;&lt;</span> scientific <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> right <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span></pre></td></tr><tr><td data-num="27"></td><td><pre>	<span class="token operator">&lt;&lt;</span> left <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"fixed decimal:"</span> <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> fixed <span class="token operator">&lt;&lt;</span> right <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span></pre></td></tr><tr><td data-num="28"></td><td><pre>	<span class="token operator">&lt;&lt;</span> left <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"hexidecimal:"</span> <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> uppercase <span class="token operator">&lt;&lt;</span> hexfloat <span class="token operator">&lt;&lt;</span> right <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">'\n'</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	<span class="token operator">&lt;&lt;</span> left <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"use defaults:"</span> <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> defaultfloat <span class="token operator">&lt;&lt;</span> right <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>	<span class="token operator">&lt;&lt;</span> <span class="token string">"\n\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1736"><a class="anchor" href="#exercise-1736">#</a> Exercise 17.36</h3><blockquote><p>修改上一题中的程序，打印不同的浮点数，使它们排成一列。</p></blockquote><p>解：</p><p>参考 17.36。</p><h3 id="exercise-1737"><a class="anchor" href="#exercise-1737">#</a> Exercise 17.37</h3><blockquote><p>用未格式化版本的 <code>getline</code> 逐行读取一个文件。测试你的程序，给定一个文件，既包含空行又包含长度超过你传递给 <code>geiline</code> 的字符数组大小的行。</p></blockquote><p>解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//17.37</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">//Use the unformatted version of getline to read a file a line at a time.</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//Test your program by giving it a file that contains empty lines as well as lines that are</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">//longer than the character array that you pass to getline.</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iomanip></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">//int main () &#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">//  ifstream myfile("F:\\Git\\Cpp-Primer\\ch17\\17_37_38\\test.txt");</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">//  if (myfile) cout &lt;&lt; 1 &lt;&lt; endl;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">//  char sink [250];</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">//</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">//  while(myfile.getline(sink,250))</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">//  &#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">//    cout &lt;&lt; sink &lt;&lt; endl;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">//  &#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">//  return 0;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">//&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">//17.38</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">//Extend your program from the previous exercise to print each word you read onto its own line.</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">//#include &lt;iostream></span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">//#include &lt;fstream></span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">//#include &lt;iomanip></span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">//</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment">//using namespace std;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">//</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">//int main () &#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">//  ifstream myfile ("F:\\Git\\Cpp-Primer\\ch17\\17_37_38\\test.txt");</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">//  char sink [250];</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">//</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token comment">//  while(myfile.getline(sink,250,' '))</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment">//  &#123;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token comment">//    cout &lt;&lt; sink &lt;&lt; endl;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token comment">//  &#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token comment">//  return 0;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token comment">//&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>	std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Standard Output!\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>	std<span class="token double-colon punctuation">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"Standard Error!\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>	std<span class="token double-colon punctuation">::</span>clog <span class="token operator">&lt;&lt;</span> <span class="token string">"Standard Log??\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="exercise-1738"><a class="anchor" href="#exercise-1738">#</a> Exercise 17.38</h3><blockquote><p>扩展上一题中你的程序，将读入的每个单词打印到它所在的行。</p></blockquote><p>解：</p><p>参考 17.37。</p><h3 id="exercise-1739"><a class="anchor" href="#exercise-1739">#</a> Exercise 17.39</h3><blockquote><p>对本节给出的 <code>seek</code> 程序，编写你自己的版本。</p></blockquote><p>解：</p><p>略</p><h2 id="chapter-summary"><a class="anchor" href="#chapter-summary">#</a> Chapter Summary</h2><p>🍓：）</p><div class="tags"><a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="tag"><i class="ic i-tag"></i> 读书笔记</a> <a href="/tags/C/" rel="tag"><i class="ic i-tag"></i> C++</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">Edited on</span> <time title="Modified: 2023-01-30 19:25:24" itemprop="dateModified" datetime="2023-01-30T19:25:24+08:00">2023-01-30</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> Donate</button><p>Give me a cup of [coffee]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Sakupinera WeChat Pay"><p>WeChat Pay</p></div><div><img data-src="/images/alipay.png" alt="Sakupinera Alipay"><p>Alipay</p></div><div><img data-src="/images/paypal.png" alt="Sakupinera PayPal"><p>PayPal</p></div></div></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>Sakupinera <i class="ic i-at"><em>@</em></i>Sakupinera</li><li class="link"><strong>Post link: </strong><a href="http://sakupinera.github.io/2023/01/09/cpp/cpp-primer/Chapter%2017%20Specialized%20Library%20Facilities/" title="C++ Primer - Chapter 17 Specialized Library Facilities">http://sakupinera.github.io/2023/01/09/cpp/cpp-primer/Chapter 17 Specialized Library Facilities/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/01/08/cpp/cpp-primer/Chapter%2016%20Templates%20and%20Generic%20Programming/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2023&#x2F;03&#x2F;08&#x2F;R9PEJQ54o7HMAis.jpg" title="C++ Primer - Chapter 16 Templates and Generic Programming"><span class="type">Previous Post</span> <span class="category"><i class="ic i-flag"></i> Cpp-Primer</span><h3>C++ Primer - Chapter 16 Templates and Generic Programming</h3></a></div><div class="item right"><a href="/2023/01/10/cpp/cpp-primer/Chapter%2018%20Tools%20for%20Large%20Programs/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2023&#x2F;03&#x2F;08&#x2F;dhkXYZz7ENHoCeL.png" title="C++ Primer - Chapter 18 Tools for Large Programs"><span class="type">Next Post</span> <span class="category"><i class="ic i-flag"></i> Cpp-Primer</span><h3>C++ Primer - Chapter 18 Tools for Large Programs</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-17-specialized-library-facilities"><span class="toc-number">1.</span> <span class="toc-text">Chapter 17 Specialized Library Facilities</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#the-tuple-type"><span class="toc-number">1.1.</span> <span class="toc-text">The tuple Type</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tuple%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">tuple 类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%92%8C%E5%88%9D%E5%A7%8B%E5%8C%96tuple"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">定义和初始化 tuple</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8tuple%E8%BF%94%E5%9B%9E%E5%A4%9A%E4%B8%AA%E5%80%BC"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">使用 tuple 返回多个值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-171"><span class="toc-number">1.1.2.</span> <span class="toc-text">Exercise 17.1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-172"><span class="toc-number">1.1.3.</span> <span class="toc-text">Exercise 17.2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-173"><span class="toc-number">1.1.4.</span> <span class="toc-text">Exercise 17.3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-174"><span class="toc-number">1.1.5.</span> <span class="toc-text">Exercise 17.4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-175"><span class="toc-number">1.1.6.</span> <span class="toc-text">Exercise 17.5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-176"><span class="toc-number">1.1.7.</span> <span class="toc-text">Exercise 17.6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-177"><span class="toc-number">1.1.8.</span> <span class="toc-text">Exercise 17.7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-178"><span class="toc-number">1.1.9.</span> <span class="toc-text">Exercise 17.8</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-bitset-type"><span class="toc-number">1.2.</span> <span class="toc-text">The bitset Type</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bitset%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text">bitset 类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-179"><span class="toc-number">1.2.2.</span> <span class="toc-text">Exercise 17.9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1710"><span class="toc-number">1.2.3.</span> <span class="toc-text">Exercise 17.10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1711"><span class="toc-number">1.2.4.</span> <span class="toc-text">Exercise 17.11</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1712"><span class="toc-number">1.2.5.</span> <span class="toc-text">Exercise 17.12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1713"><span class="toc-number">1.2.6.</span> <span class="toc-text">Exercise 17.13</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#regular-expressions"><span class="toc-number">1.3.</span> <span class="toc-text">Regular Expressions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.3.1.</span> <span class="toc-text">正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%BA%93"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">使用正则表达式库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E4%B8%8Eregex%E8%BF%AD%E4%BB%A3%E5%99%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">匹配与 regex 迭代器类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%AD%90%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">使用子表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8regex_replace"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">使用 regex_replace</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1714"><span class="toc-number">1.3.2.</span> <span class="toc-text">Exercise 17.14</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1715"><span class="toc-number">1.3.3.</span> <span class="toc-text">Exercise 17.15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1716"><span class="toc-number">1.3.4.</span> <span class="toc-text">Exercise 17.16</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1717"><span class="toc-number">1.3.5.</span> <span class="toc-text">Exercise 17.17</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1718"><span class="toc-number">1.3.6.</span> <span class="toc-text">Exercise 17.18</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1719"><span class="toc-number">1.3.7.</span> <span class="toc-text">Exercise 17.19</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1720"><span class="toc-number">1.3.8.</span> <span class="toc-text">Exercise 17.20</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1721"><span class="toc-number">1.3.9.</span> <span class="toc-text">Exercise 17.21</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1722"><span class="toc-number">1.3.10.</span> <span class="toc-text">Exercise 17.22</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1723"><span class="toc-number">1.3.11.</span> <span class="toc-text">Exercise 17.23</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1724"><span class="toc-number">1.3.12.</span> <span class="toc-text">Exercise 17.24</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1725"><span class="toc-number">1.3.13.</span> <span class="toc-text">Exercise 17.25</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1726"><span class="toc-number">1.3.14.</span> <span class="toc-text">Exercise 17.26</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1727"><span class="toc-number">1.3.15.</span> <span class="toc-text">Exercise 17.27</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#random-numbers"><span class="toc-number">1.4.</span> <span class="toc-text">Random Numbers</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%95%B0"><span class="toc-number">1.4.1.</span> <span class="toc-text">随机数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%BC%95%E6%93%8E%E5%92%8C%E5%88%86%E5%B8%83"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">随机数引擎和分布</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%88%86%E5%B8%83"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">其他随机数分布</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1728"><span class="toc-number">1.4.2.</span> <span class="toc-text">Exercise 17.28</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1729"><span class="toc-number">1.4.3.</span> <span class="toc-text">Exercise 17.29</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1730"><span class="toc-number">1.4.4.</span> <span class="toc-text">Exercise 17.30</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1731"><span class="toc-number">1.4.5.</span> <span class="toc-text">Exercise 17.31</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1732"><span class="toc-number">1.4.6.</span> <span class="toc-text">Exercise 17.32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1733"><span class="toc-number">1.4.7.</span> <span class="toc-text">Exercise 17.33</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-io-library-revisited"><span class="toc-number">1.5.</span> <span class="toc-text">The IO Library Revisited</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#io%E5%BA%93%E5%86%8D%E6%8E%A2"><span class="toc-number">1.5.1.</span> <span class="toc-text">IO 库再探</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%85%A5%E4%B8%8E%E8%BE%93%E5%87%BA"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">格式化输入与输出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AA%E6%A0%BC%E5%BC%8F%E5%8C%96%E7%9A%84%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">未格式化的输入 &#x2F; 输出操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E9%9A%8F%E6%9C%BA%E8%AE%BF%E9%97%AE"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">流随机访问</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1734"><span class="toc-number">1.5.2.</span> <span class="toc-text">Exercise 17.34</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1735"><span class="toc-number">1.5.3.</span> <span class="toc-text">Exercise 17.35</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1736"><span class="toc-number">1.5.4.</span> <span class="toc-text">Exercise 17.36</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1737"><span class="toc-number">1.5.5.</span> <span class="toc-text">Exercise 17.37</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1738"><span class="toc-number">1.5.6.</span> <span class="toc-text">Exercise 17.38</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exercise-1739"><span class="toc-number">1.5.7.</span> <span class="toc-text">Exercise 17.39</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chapter-summary"><span class="toc-number">1.6.</span> <span class="toc-text">Chapter Summary</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="Related"><ul><li><a href="/2022/12/09/cpp/cpp-primer/Chapter%201%20Getting%20Started/" rel="bookmark" title="C++ Primer - Chapter 1 Getting Started">C++ Primer - Chapter 1 Getting Started</a></li><li><a href="/2022/12/10/cpp/cpp-primer/Chapter%202%20Variables%20and%20Basic%20Types/" rel="bookmark" title="C++ Primer - Chapter 2 Variables and Basic Types">C++ Primer - Chapter 2 Variables and Basic Types</a></li><li><a href="/2022/12/11/cpp/cpp-primer/Chapter%203%20Strings,%20Vectors,%20and%20Arrays/" rel="bookmark" title="C++ Primer - Chapter 3 Strings, Vectors, and Arrays">C++ Primer - Chapter 3 Strings, Vectors, and Arrays</a></li><li><a href="/2022/12/12/cpp/cpp-primer/Chapter%204%20Expressions/" rel="bookmark" title="C++ Primer - Chapter 4 Expressions">C++ Primer - Chapter 4 Expressions</a></li><li><a href="/2022/12/13/cpp/cpp-primer/Chapter%205%20Statements/" rel="bookmark" title="C++ Primer - Chapter 5 Statements">C++ Primer - Chapter 5 Statements</a></li><li><a href="/2022/12/14/cpp/cpp-primer/Chapter%206%20Functions/" rel="bookmark" title="C++ Primer - Chapter 6 Functions">C++ Primer - Chapter 6 Functions</a></li><li><a href="/2022/12/15/cpp/cpp-primer/Chapter%207%20Classes/" rel="bookmark" title="C++ Primer - Chapter 7 Classes">C++ Primer - Chapter 7 Classes</a></li><li><a href="/2022/12/16/cpp/cpp-primer/Chapter%208%20The%20IO%20Library/" rel="bookmark" title="C++ Primer - Chapter 8 The IO Library">C++ Primer - Chapter 8 The IO Library</a></li><li><a href="/2022/12/17/cpp/cpp-primer/Chapter%209%20Sequential%20Containers/" rel="bookmark" title="C++ Primer - Chapter 9 Sequential Containers">C++ Primer - Chapter 9 Sequential Containers</a></li><li><a href="/2023/01/02/cpp/cpp-primer/Chapter%2010%20Generic%20Algorithms/" rel="bookmark" title="C++ Primer - Chapter 10 Generic Algorithms">C++ Primer - Chapter 10 Generic Algorithms</a></li><li><a href="/2023/01/03/cpp/cpp-primer/Chapter%2011%20Associative%20Containers/" rel="bookmark" title="C++ Primer - Chapter 11 Associative Containers">C++ Primer - Chapter 11 Associative Containers</a></li><li><a href="/2023/01/04/cpp/cpp-primer/Chapter%2012%20Dynamic%20Memory/" rel="bookmark" title="C++ Primer - Chapter 12 Dynamic Memory">C++ Primer - Chapter 12 Dynamic Memory</a></li><li><a href="/2023/01/05/cpp/cpp-primer/Chapter%2013%20Copy%20Control/" rel="bookmark" title="C++ Primer - Chapter 13 Copy Control">C++ Primer - Chapter 13 Copy Control</a></li><li><a href="/2023/01/06/cpp/cpp-primer/Chapter%2014%20Overloaded%20Operations%20and%20Conversions/" rel="bookmark" title="C++ Primer - Chapter 14 Overloaded Operations and Conversions">C++ Primer - Chapter 14 Overloaded Operations and Conversions</a></li><li><a href="/2023/01/07/cpp/cpp-primer/Chapter%2015%20Object-Oriented%20Programming/" rel="bookmark" title="C++ Primer - Chapter 15 Object-Oriented Programming">C++ Primer - Chapter 15 Object-Oriented Programming</a></li><li><a href="/2023/01/08/cpp/cpp-primer/Chapter%2016%20Templates%20and%20Generic%20Programming/" rel="bookmark" title="C++ Primer - Chapter 16 Templates and Generic Programming">C++ Primer - Chapter 16 Templates and Generic Programming</a></li><li class="active"><a href="/2023/01/09/cpp/cpp-primer/Chapter%2017%20Specialized%20Library%20Facilities/" rel="bookmark" title="C++ Primer - Chapter 17 Specialized Library Facilities">C++ Primer - Chapter 17 Specialized Library Facilities</a></li><li><a href="/2023/01/10/cpp/cpp-primer/Chapter%2018%20Tools%20for%20Large%20Programs/" rel="bookmark" title="C++ Primer - Chapter 18 Tools for Large Programs">C++ Primer - Chapter 18 Tools for Large Programs</a></li><li><a href="/2023/01/11/cpp/cpp-primer/Chapter%2019%20Specialized%20Tools%20and%20Techniques/" rel="bookmark" title="C++ Primer - Chapter 19 Specialized Tools and Techniques">C++ Primer - Chapter 19 Specialized Tools and Techniques</a></li></ul></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Sakupinera" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Sakupinera</p><div class="description" itemprop="description">保持你的决心！</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">86</span> <span class="name">posts</span></a></div><div class="item categories"><a href="/categories/"><span class="count">13</span> <span class="name">categories</span></a></div><div class="item tags"><a href="/tags/"><span class="count">6</span> <span class="name">tags</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Nha3VwaW5lcmE=" title="https:&#x2F;&#x2F;github.com&#x2F;sakupinera"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9zYWt1cGluZXJh" title="https:&#x2F;&#x2F;twitter.com&#x2F;sakupinera"><i class="ic i-twitter"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTQwNzIyOTA3MQ==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;407229071"><i class="ic i-cloud-music"></i></span> <span class="exturl item bilibili" data-url="aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vMjIzMDczOTg/c3BtX2lkX2Zyb209MzMzLjEwMDcuMC4w" title="https:&#x2F;&#x2F;space.bilibili.com&#x2F;22307398?spm_id_from&#x3D;333.1007.0.0"><i class="ic i-bilibili"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a></li></ul></li><li class="item"><a href="/games/" rel="section"><i class="ic i-flag"></i>Games</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-person"></i>About</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/01/08/cpp/cpp-primer/Chapter%2016%20Templates%20and%20Generic%20Programming/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/01/10/cpp/cpp-primer/Chapter%2018%20Tools%20for%20Large%20Programs/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/CSharp/" title="In CSharp">CSharp</a> <i class="ic i-angle-right"></i> <a href="/categories/CSharp/CSharp-in-a-Nutshell/" title="In CSharp-in-a-Nutshell">CSharp-in-a-Nutshell</a></div><span><a href="/2022/08/30/csharp/csharp-in-a-nutshell/%E7%AC%AC8%E7%AB%A0%20LINQ%E6%9F%A5%E8%AF%A2/" title="C# in a Nutshell - 第8章 LINQ查询">C# in a Nutshell - 第8章 LINQ查询</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Cpp/" title="In Cpp">Cpp</a> <i class="ic i-angle-right"></i> <a href="/categories/Cpp/Cpp-Primer/" title="In Cpp-Primer">Cpp-Primer</a></div><span><a href="/2023/01/04/cpp/cpp-primer/Chapter%2012%20Dynamic%20Memory/" title="C++ Primer - Chapter 12 Dynamic Memory">C++ Primer - Chapter 12 Dynamic Memory</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CSharp/" title="In CSharp">CSharp</a> <i class="ic i-angle-right"></i> <a href="/categories/CSharp/CLR-via-CSharp/" title="In CLR-via-CSharp">CLR-via-CSharp</a></div><span><a href="/2023/02/09/csharp/clr-via-csharp/Chapter%2029%20Primitive%20Thread%20Synchronization%20Constructs/" title="CLR via C# - Chapter 29 Primitive Thread Synchronization">CLR via C# - Chapter 29 Primitive Thread Synchronization</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Linux/" title="In Linux">Linux</a> <i class="ic i-angle-right"></i> <a href="/categories/Linux/Learn-Linux/" title="In Learn-Linux">Learn-Linux</a></div><span><a href="/2022/08/28/linux/learn-linux/%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E7%AE%A1%E7%90%86/" title="LearnLinux - 用户和用户组管理">LearnLinux - 用户和用户组管理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Linux/" title="In Linux">Linux</a> <i class="ic i-angle-right"></i> <a href="/categories/Linux/Learn-Linux/" title="In Learn-Linux">Learn-Linux</a></div><span><a href="/2022/09/05/linux/learn-linux/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/" title="LearnLinux - 备份与恢复">LearnLinux - 备份与恢复</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Cpp/" title="In Cpp">Cpp</a> <i class="ic i-angle-right"></i> <a href="/categories/Cpp/Cpp-Primer/" title="In Cpp-Primer">Cpp-Primer</a></div><span><a href="/2023/01/03/cpp/cpp-primer/Chapter%2011%20Associative%20Containers/" title="C++ Primer - Chapter 11 Associative Containers">C++ Primer - Chapter 11 Associative Containers</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CSharp/" title="In CSharp">CSharp</a> <i class="ic i-angle-right"></i> <a href="/categories/CSharp/CLR-via-CSharp/" title="In CLR-via-CSharp">CLR-via-CSharp</a></div><span><a href="/2022/08/28/csharp/clr-via-csharp/Chapter%203%20Shared%20Assemblies%20and%20Strongly%20Named%20Assemblies/" title="CLR via C# - Chapter 3 Shared Assemblies and Strongly Named Assemblies">CLR via C# - Chapter 3 Shared Assemblies and Strongly Named Assemblies</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Computer-Graphics/" title="In Computer-Graphics">Computer-Graphics</a> <i class="ic i-angle-right"></i> <a href="/categories/Computer-Graphics/GAMES101/" title="In GAMES101">GAMES101</a></div><span><a href="/2022/09/06/computer-graphics/games101/%E5%90%91%E9%87%8F%E5%92%8C%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/" title="GAMES101 - 向量和线性代数">GAMES101 - 向量和线性代数</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CSharp/" title="In CSharp">CSharp</a> <i class="ic i-angle-right"></i> <a href="/categories/CSharp/CLR-via-CSharp/" title="In CLR-via-CSharp">CLR-via-CSharp</a></div><span><a href="/2022/12/06/csharp/clr-via-csharp/Chapter%2025%20Interoperating%20with%20WinRT%20%20Components/" title="CLR via C# - Chapter 25 Interoperating with WinRT Components">CLR via C# - Chapter 25 Interoperating with WinRT Components</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CSharp/" title="In CSharp">CSharp</a> <i class="ic i-angle-right"></i> <a href="/categories/CSharp/CLR-via-CSharp/" title="In CLR-via-CSharp">CLR-via-CSharp</a></div><span><a href="/2022/11/02/csharp/clr-via-csharp/Chapter%2012%20Generics/" title="CLR via C# - Chapter 12 Generics">CLR via C# - Chapter 12 Generics</a></span></li></ul></div><div><h2>Recent Comments</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Sakupinera @ Hanamai Sora</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="Symbols count total">2.2m words</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="Reading time total">33:30</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/01/09/cpp/cpp-primer/Chapter 17 Specialized Library Facilities/",favicon:{show:"（●´3｀●）Goooood",hide:"(´Д｀)Booooom"},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,fancybox:!0,copyright:'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/shifuku.model.json"},display:{position:"left",width:250,height:500},mobile:{show:!1},react:{opacity:.9},log:!1})</script></body></html>